<!DOCTYPE html>
<html>
<head>
    <title>Backend Test</title>
</head>
<body>
    <h1>Quiz Generation Backend Test</h1>
    <button onclick="testBackend()">Test Backend Connection</button>
    <button onclick="testGeminiDirect()">Test Gemini Direct</button>
    <div id="results"></div>

    <script>
        async function testBackend() {
            const results = document.getElementById('results');
            results.innerHTML = '<h3>Testing Backend...</h3>';
            
            try {
                // Test 1: Check if backend is running
                console.log('Testing backend connectivity...');
                const response = await fetch('http://localhost:8080/api/ai/gemini-generate-quiz', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        topic: 'React useContext',
                        questionCount: 3,
                        difficulty: 'intermediate',
                        courseContext: 'Web Development'
                    })
                });
                
                console.log('Response status:', response.status);
                const data = await response.text();
                console.log('Response data:', data);
                
                if (response.ok) {
                    results.innerHTML += '<p style="color: green;">✅ Backend is working!</p>';
                    results.innerHTML += '<pre>' + data + '</pre>';
                } else {
                    results.innerHTML += '<p style="color: red;">❌ Backend error: ' + response.status + '</p>';
                    results.innerHTML += '<pre>' + data + '</pre>';
                }
            } catch (error) {
                console.error('Backend test failed:', error);
                results.innerHTML += '<p style="color: red;">❌ Backend connection failed: ' + error.message + '</p>';
                results.innerHTML += '<p>Make sure Spring Boot is running on port 8080</p>';
            }
        }
        
        async function testGeminiDirect() {
            const results = document.getElementById('results');
            results.innerHTML = '<h3>Testing Gemini Direct...</h3>';
            
            try {
                const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=AIzaSyCAysFPEB1sViDLawNDmKmFYQMfnFxTxJk', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: 'Generate 2 multiple choice questions about React useContext. Return as JSON array.'
                            }]
                        }]
                    })
                });
                
                console.log('Gemini response status:', response.status);
                const data = await response.json();
                console.log('Gemini response data:', data);
                
                if (response.ok) {
                    results.innerHTML += '<p style="color: green;">✅ Gemini API is working!</p>';
                    results.innerHTML += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                } else {
                    results.innerHTML += '<p style="color: red;">❌ Gemini API error: ' + response.status + '</p>';
                    results.innerHTML += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                }
            } catch (error) {
                console.error('Gemini test failed:', error);
                results.innerHTML += '<p style="color: red;">❌ Gemini API failed: ' + error.message + '</p>';
            }
        }
    </script>
</body>
</html>
